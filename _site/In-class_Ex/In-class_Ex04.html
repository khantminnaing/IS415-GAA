<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Khant Min Naing">
<meta name="dcterms.date" content="2024-01-29">
<meta name="description" content="Local Spatial Autocorrelation Statistics (LISA)">

<title>IS415 - Geospatial with Khant - In-Class Exercise 04</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<link rel="stylesheet" href="../styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">IS415 - Geospatial with Khant</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-in-class-exercises" role="button" data-bs-toggle="dropdown" aria-expanded="false" rel="" target="">
 <span class="menu-text">In-Class Exercises</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-in-class-exercises">    
        <li>
    <a class="dropdown-item" href="../In-class_Ex/In-class_Ex02.html" rel="" target="">
 <span class="dropdown-text">In-Class Exercise 02</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../In-class_Ex/In-class_Ex03.html" rel="" target="">
 <span class="dropdown-text">In-Class Exercise 03</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../In-class_Ex/In-class_Ex03-NKDE.html" rel="" target="">
 <span class="dropdown-text">In-Class Exercise 03 NKDE</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../In-class_Ex/In-class_Ex04.html" rel="" target="">
 <span class="dropdown-text">In-Class Exercise 04</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../In-class_Ex/In-class_Ex05.html" rel="" target="">
 <span class="dropdown-text">In-Class Exercise 05</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-hands-on-exercises" role="button" data-bs-toggle="dropdown" aria-expanded="false" rel="" target="">
 <span class="menu-text">Hands-On Exercises</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-hands-on-exercises">    
        <li>
    <a class="dropdown-item" href="../Hands-on_Ex/hands_on1.html" rel="" target="">
 <span class="dropdown-text">Hands-On Exercise 1</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../Hands-on_Ex/hands_on02.html" rel="" target="">
 <span class="dropdown-text">Hands-On Exercise 2</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../Hands-on_Ex/hands_on03.html" rel="" target="">
 <span class="dropdown-text">Hands-On Exercise 3</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../Hands-on_Ex/hands_on04.html" rel="" target="">
 <span class="dropdown-text">Hands-On Exercise 4</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../Hands-on_Ex/hands_on05.html" rel="" target="">
 <span class="dropdown-text">Hands-On Exercise 5</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-take-home-exercises" role="button" data-bs-toggle="dropdown" aria-expanded="false" rel="" target="">
 <span class="menu-text">Take-home Exercises</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-take-home-exercises">    
        <li>
    <a class="dropdown-item" href="../Take-home_Ex/Take-home_Ex01.html" rel="" target="">
 <span class="dropdown-text">Take-home Exercise 1</span></a>
  </li>  
    </ul>
  </li>
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../index.html" rel="" target="">
 <span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../about.html" rel="" target="">
 <span class="menu-text">About</span></a>
  </li>  
</ul>
            <div class="quarto-navbar-tools">
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#in-class-exercise-04" id="toc-in-class-exercise-04" class="nav-link active" data-scroll-target="#in-class-exercise-04">In-Class Exercise 04</a>
  <ul class="collapse">
  <li><a href="#overview" id="toc-overview" class="nav-link" data-scroll-target="#overview">1.0 Overview</a></li>
  <li><a href="#importing-packages" id="toc-importing-packages" class="nav-link" data-scroll-target="#importing-packages">2.0 Importing Packages</a></li>
  <li><a href="#importing-datasets-to-r-environment" id="toc-importing-datasets-to-r-environment" class="nav-link" data-scroll-target="#importing-datasets-to-r-environment">3.0 Importing Datasets to R Environment</a>
  <ul class="collapse">
  <li><a href="#importing-geospatial-data" id="toc-importing-geospatial-data" class="nav-link" data-scroll-target="#importing-geospatial-data">3.1 Importing Geospatial Data</a></li>
  <li><a href="#importing-aspatial-data" id="toc-importing-aspatial-data" class="nav-link" data-scroll-target="#importing-aspatial-data">3.1 Importing Aspatial Data</a></li>
  </ul></li>
  <li><a href="#geospatial-data-wrangling" id="toc-geospatial-data-wrangling" class="nav-link" data-scroll-target="#geospatial-data-wrangling">4.0 Geospatial Data Wrangling</a>
  <ul class="collapse">
  <li><a href="#performing-relational-joint" id="toc-performing-relational-joint" class="nav-link" data-scroll-target="#performing-relational-joint">4.1. Performing Relational Joint</a></li>
  <li><a href="#conversion-to-spatialpoint-object" id="toc-conversion-to-spatialpoint-object" class="nav-link" data-scroll-target="#conversion-to-spatialpoint-object">4.2 Conversion to SpatialPoint Object</a></li>
  </ul></li>
  <li><a href="#geographically-weighted-summary-statistics-gwss" id="toc-geographically-weighted-summary-statistics-gwss" class="nav-link" data-scroll-target="#geographically-weighted-summary-statistics-gwss">5.0 <strong>Geographically Weighted Summary Statistics (GWSS)</strong></a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">In-Class Exercise 04</h1>
  <div class="quarto-categories">
    <div class="quarto-category">In-Class Exercise</div>
    <div class="quarto-category">R</div>
    <div class="quarto-category">sf</div>
    <div class="quarto-category">sfdep</div>
  </div>
  </div>

<div>
  <div class="description">
    <p>Local Spatial Autocorrelation Statistics (LISA)</p>
  </div>
</div>


<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p><a href="https://www.linkedin.com/in/khantminnaing/">Khant Min Naing</a> </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">January 29, 2024</p>
    </div>
  </div>
  
    <div>
    <div class="quarto-title-meta-heading">Modified</div>
    <div class="quarto-title-meta-contents">
      <p class="date-modified">February 5, 2024</p>
    </div>
  </div>
    
  </div>
  

</header>

<section id="in-class-exercise-04" class="level1">
<h1>In-Class Exercise 04</h1>
<section id="overview" class="level2">
<h2 class="anchored" data-anchor-id="overview">1.0 Overview</h2>
<p>Spatial weights are a key component in any cross-sectional analysis of spatial dependence. They are an essential element in the construction of spatial autocorrelation statistics, and provide the means to create spatially explicit variables, such as spatially lagged variables and spatially smoothed rates. Computing spatial weight is an essential step toward measuring the strength of the spatial relationships between objects. In this exercise, the basic concept of spatial weight will be introduced. This is followed by a discussion of methods to compute spatial weights. Particularly, we will explore using <strong>spdep</strong> and <strong>GWmodel</strong>.</p>
</section>
<section id="importing-packages" class="level2">
<h2 class="anchored" data-anchor-id="importing-packages">2.0 Importing Packages</h2>
<p>In this hands-on exercise, we will use the following R package:</p>
<ul>
<li><p><a href="https://r-spatial.github.io/sf/"><strong>sf</strong></a></p></li>
<li><p>sp</p></li>
<li><p><strong>spdep</strong>,</p></li>
<li><p><a href="https://cran.r-project.org/web/packages/tmap/"><strong>tmap</strong></a></p></li>
<li><p><strong>tidyverse</strong></p></li>
<li><p><strong>knitr</strong></p></li>
<li><p><strong>GWmodel</strong></p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(sf, sp, spdep, tmap, tidyverse, knitr, GWmodel)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="importing-datasets-to-r-environment" class="level2">
<h2 class="anchored" data-anchor-id="importing-datasets-to-r-environment">3.0 Importing Datasets to R Environment</h2>
<p>In this exercise, we will use the following datasets:</p>
<ul>
<li><p><code>Hunan</code> county boundary layer. This is a geospatial data set in ESRI shapefile format.</p></li>
<li><p><code>Hunan_2012.csv</code> This csv file contains selected Hunan’s local development indicators in 2012.</p></li>
</ul>
<section id="importing-geospatial-data" class="level3">
<h3 class="anchored" data-anchor-id="importing-geospatial-data">3.1 Importing Geospatial Data</h3>
<p>In this section, <code>st_read()</code> of <strong>sf</strong> package will be used to import the three geospatial data sets mentioned in previous section into R environment.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>hunan <span class="ot">&lt;-</span> <span class="fu">st_read</span>(<span class="at">dsn =</span> <span class="st">"../data/geospatial"</span>, </span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>                 <span class="at">layer =</span> <span class="st">"Hunan"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Reading layer `Hunan' from data source 
  `/Users/khantminnaing/IS415-GAA/data/geospatial' using driver `ESRI Shapefile'
Simple feature collection with 88 features and 7 fields
Geometry type: POLYGON
Dimension:     XY
Bounding box:  xmin: 108.7831 ymin: 24.6342 xmax: 114.2544 ymax: 30.12812
Geodetic CRS:  WGS 84</code></pre>
</div>
</div>
</section>
<section id="importing-aspatial-data" class="level3">
<h3 class="anchored" data-anchor-id="importing-aspatial-data">3.1 Importing Aspatial Data</h3>
<p>In this section, <code>read_csv()</code> of <strong>sf</strong> package will be used to import the csv file into R environment. The output is R dataframe class.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>hunan2012 <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"../data/aspatial/Hunan_2012.csv"</span>)</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>hunan2012</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 88 × 29
   County    City   avg_wage deposite    FAI Gov_Rev Gov_Exp    GDP GDPPC    GIO
   &lt;chr&gt;     &lt;chr&gt;     &lt;dbl&gt;    &lt;dbl&gt;  &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt;
 1 Anhua     Yiyang    30544   10967   6832.    457.   2703  13225  14567  9277.
 2 Anren     Chenz…    28058    4599.  6386.    221.   1455.  4941. 12761  4189.
 3 Anxiang   Chang…    31935    5517.  3541     244.   1780. 12482  23667  5109.
 4 Baojing   Hunan…    30843    2250   1005.    193.   1379.  4088. 14563  3624.
 5 Chaling   Zhuzh…    31251    8241.  6508.    620.   1947  11585  20078  9158.
 6 Changning Hengy…    28518   10860   7920     770.   2632. 19886  24418 37392 
 7 Changsha  Chang…    54540   24332  33624    5350    7886. 88009  88656 51361 
 8 Chengbu   Shaoy…    28597    2581.  1922.    161.   1192.  2570. 10132  1681.
 9 Chenxi    Huaih…    33580    4990   5818.    460.   1724.  7755. 17026  6644.
10 Cili      Zhang…    33099    8117.  4498.    500.   2306. 11378  18714  5843.
# ℹ 78 more rows
# ℹ 19 more variables: Loan &lt;dbl&gt;, NIPCR &lt;dbl&gt;, Bed &lt;dbl&gt;, Emp &lt;dbl&gt;,
#   EmpR &lt;dbl&gt;, EmpRT &lt;dbl&gt;, Pri_Stu &lt;dbl&gt;, Sec_Stu &lt;dbl&gt;, Household &lt;dbl&gt;,
#   Household_R &lt;dbl&gt;, NOIP &lt;dbl&gt;, Pop_R &lt;dbl&gt;, RSCG &lt;dbl&gt;, Pop_T &lt;dbl&gt;,
#   Agri &lt;dbl&gt;, Service &lt;dbl&gt;, Disp_Inc &lt;dbl&gt;, RORP &lt;dbl&gt;, ROREmp &lt;dbl&gt;</code></pre>
</div>
</div>
</section>
</section>
<section id="geospatial-data-wrangling" class="level2">
<h2 class="anchored" data-anchor-id="geospatial-data-wrangling">4.0 Geospatial Data Wrangling</h2>
<section id="performing-relational-joint" class="level3">
<h3 class="anchored" data-anchor-id="performing-relational-joint">4.1. Performing Relational Joint</h3>
<p>In previous section, we have imported a shapefile <code>hunan</code> representing the geographical boundaries of Hunan and a dataframe <code>hunan2012</code> which contains the attribute fields corresponding to counties in <code>Hunan</code>.</p>
<p>The next step in our analysis involves updating the attribute table of the <code>hunan</code> shapefile with the values from <code>hunan2012</code>.</p>
<p>Hence, we will need to update the attribute table of <code>Hunan</code> by using <code>left_join()</code> of dplyr package. This function effectively merges the two datasets, ensuring that each county’s geographical data is accurately linked with its corresponding attribute data from the <strong><code>hunan2012</code></strong> dataframe.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>hunan <span class="ot">&lt;-</span> <span class="fu">left_join</span>(hunan,hunan2012, <span class="fu">join_by</span>(County))<span class="sc">%&gt;%</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>, <span class="dv">7</span>, <span class="dv">15</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="conversion-to-spatialpoint-object" class="level3">
<h3 class="anchored" data-anchor-id="conversion-to-spatialpoint-object">4.2 Conversion to SpatialPoint Object</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>hunan_sp <span class="ot">&lt;-</span> hunan <span class="sc">%&gt;%</span> <span class="fu">as_Spatial</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="geographically-weighted-summary-statistics-gwss" class="level2">
<h2 class="anchored" data-anchor-id="geographically-weighted-summary-statistics-gwss">5.0 <strong>Geographically Weighted Summary Statistics (GWSS)</strong></h2>
<p>This function calculates basic and robust GWSS, including geographically weighted means, standard deviations and skew. Robust alternatives include geographically weighted medians, inter-quartile ranges and quantile imbalances. This function also calculates basic geographically weighted covariances together with basic and robust geographically weighted correlations.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>gwstat <span class="ot">&lt;-</span> <span class="fu">gwss</span>(<span class="at">data=</span> hunan_sp,</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>               <span class="at">vars =</span> <span class="st">"GDPPC"</span>,</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>               <span class="at">bw =</span> <span class="dv">6</span>,</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>               <span class="at">kernel =</span> <span class="st">"bisquare"</span>,</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>               <span class="at">adaptive =</span> <span class="cn">TRUE</span>,</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>               <span class="at">longlat =</span> T)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><strong>What can we learn from this code chunk?</strong></p>
<ol type="1">
<li><p>The <strong><code>data</code></strong> argument is set to <strong><code>hunan_sp</code></strong>, which means the data being used is stored in the <strong><code>hunan_sp</code></strong> variable.</p></li>
<li><p>The <strong><code>vars</code></strong> argument is set to <strong><code>"GDPPC"</code></strong>. This indicates that the variable of interest in the <strong><code>hunan_sp</code></strong> data is <strong><code>"GDPPC"</code></strong>.</p></li>
<li><p>The <strong><code>bw</code></strong> argument is set to <strong><code>6</code></strong>. This is the bandwidth parameter for the geographical weighting, which controls the degree of smoothing.</p></li>
<li><p>The <strong><code>kernel</code></strong> argument is set to <strong><code>"bisquare"</code></strong>. This means the bisquare kernel function is used for weighting.</p></li>
<li><p>The <strong><code>adaptive</code></strong> argument is set to <strong><code>TRUE</code></strong>, which means the bandwidth is adaptive. In other words, the bandwidth adjusts depending on the density of the data points.</p></li>
<li><p>The <strong><code>longlat</code></strong> argument is set to <strong><code>T</code></strong> (short for <strong><code>TRUE</code></strong>). This indicates that the data’s coordinates are in longitude and latitude.</p></li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>gwstat</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   ***********************************************************************
   *                       Package   GWmodel                             *
   ***********************************************************************

   ***********************Calibration information*************************

   Local summary statistics calculated for variables:
    GDPPC
   Number of summary points: 88
   Kernel function: bisquare 
   Summary points: the same locations as observations are used.
   Adaptive bandwidth: 6 (number of nearest neighbours)
   Distance metric: Great Circle distance metric is used.

   ************************Local Summary Statistics:**********************
   Summary information for Local means:
GDPPC_LM 
    Min.  1st Qu.   Median  3rd Qu.     Max. 
10313.11 17616.21 21981.39 28547.05 73545.30 
   Summary information for local standard deviation :
GDPPC_LSD 
      Min.    1st Qu.     Median    3rd Qu.       Max. 
  926.3095  3319.0782  5041.7997  7602.3637 24377.4421 
   Summary information for local variance :
GDPPC_LVar 
       Min.     1st Qu.      Median     3rd Qu.        Max. 
   858049.3  11030994.6  25419746.0  57798649.1 594259684.0 
   Summary information for Local skewness:
GDPPC_LSKe 
       Min.     1st Qu.      Median     3rd Qu.        Max. 
-3.74328455 -0.06903772  0.74202796  1.20539540  5.98374890 
   Summary information for localized coefficient of variation:
GDPPC_LCV 
      Min.    1st Qu.     Median    3rd Qu.       Max. 
0.04955751 0.15100369 0.22079470 0.33316203 0.95567593 

   ************************************************************************</code></pre>
</div>
</div>
<p>The output of the <code>gwss()</code> function is a SpatialPointsDataFrame (SDF). We can view the values inside this dataframe.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>gwstat_df <span class="ot">&lt;-</span> gwstat[[<span class="st">"SDF"</span>]]<span class="sc">@</span>data</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>gwstat_df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   GDPPC_LM  GDPPC_LSD  GDPPC_LVar  GDPPC_LSKe  GDPPC_LCV
1  26797.76  5368.4595  28820357.0  0.66633204 0.20033243
2  21194.35  1698.0390   2883336.3  2.09614479 0.08011754
3  27755.09  4825.3960  23284446.3  0.64707878 0.17385627
4  27142.60  4146.6643  17194824.5  1.16119871 0.15277327
5  27681.99  4332.3440  18769204.5  0.92967739 0.15650406
6  24249.16  3670.7229  13474206.9 -0.85466668 0.15137523
7  59246.71 22419.9966 502656247.4 -0.62939642 0.37841757
8  50685.94 16702.7409 278981554.2 -0.86488843 0.32953402
9  69729.10 15306.7753 234297370.2 -0.84589675 0.21951775
10 19740.12  8635.5046  74571939.8  1.07796143 0.43745947
11 24375.01 22290.1025 496848668.9  1.18483157 0.91446544
12 29322.23  5962.4104  35550337.5 -1.88571194 0.20334096
13 23969.10  5043.2717  25434589.3  0.56523820 0.21040723
14 25383.12 24258.0380 588452406.9  1.03964154 0.95567593
15 21816.34  5040.3276  25404902.6  1.04816353 0.23103455
16 36359.36 16102.9533 259305105.8  0.56214571 0.44288329
17 42389.06 24307.7075 590864643.0 -0.32129825 0.57344291
18 23672.87  2642.5387   6983010.8 -2.57545765 0.11162733
19 27607.43  3389.1128  11486085.5  1.50576400 0.12276090
20 22223.48  1889.3881   3569787.4  0.97182679 0.08501764
21 24679.04  2679.7697   7181165.8 -1.15519704 0.10858485
22 26558.82  7204.3387  51902495.6  0.01029577 0.27125975
23 19778.52  2879.7720   8293087.0  1.11653676 0.14560101
24 18458.67  5484.3159  30077721.1  1.62822457 0.29711324
25 23423.43  7021.5422  49302054.4  0.03116617 0.29976582
26 16541.26  2397.1846   5746493.9  0.60063497 0.14492156
27 16545.42  3392.6269  11509917.5  0.06849616 0.20504933
28 15066.82  4122.0062  16990935.1  3.08938061 0.27358169
29 14821.56  3662.2795  13412290.8  0.44253465 0.24709131
30 16915.67  2471.5922   6108768.0  0.72194074 0.14611257
31 15183.78  3588.4893  12877255.6  2.94946079 0.23633700
32 21541.65  5069.4678  25699503.7 -1.43147322 0.23533329
33 19601.11  3108.9744   9665722.0  0.50522382 0.15861214
34 32412.12 24242.1346 587681090.0  0.53522173 0.74793418
35 20599.49  4617.7969  21324048.0  1.19120123 0.22417046
36 28859.13 23348.8623 545169370.5  0.85575588 0.80906328
37 11984.64  2493.0666   6215381.2  0.86286370 0.20802177
38 17861.63  4667.0959  21781784.0 -0.94299674 0.26129176
39 12911.26  2058.7063   4238271.6  0.57312479 0.15945051
40 10313.11  1358.4328   1845339.8  1.46878192 0.13171898
41 22146.45  4918.0988  24187695.5 -1.25740463 0.22207165
42 14975.46  2055.6929   4225873.1 -1.70732382 0.13727074
43 12164.44  1245.7923   1551998.4  1.22251626 0.10241262
44 13193.61  3927.1815  15422754.5  1.39569677 0.29765777
45 28443.02 24377.4421 594259684.0  0.77640738 0.85706245
46 47125.62 15312.7089 234479054.1 -0.27861152 0.32493383
47 38611.99 14830.2228 219935507.2  0.36610524 0.38408332
48 17657.75  5844.9396  34163319.0  1.30857144 0.33101270
49 17491.60  6505.9155  42326936.2  1.45654920 0.37194513
50 15515.46  7517.4264  56511699.0  1.54877539 0.48451204
51 20510.72  6286.3751  39518511.4  0.76211517 0.30649211
52 26867.31  6659.8455  44353542.2 -0.81626138 0.24787916
53 10537.76  1827.5034   3339768.6  1.73988753 0.17342427
54 21458.65  6410.2129  41090829.2  0.92850266 0.29872402
55 11158.95  2038.4420   4155245.7  0.87994007 0.18267325
56 17755.28 12355.3608 152654940.8  3.44850457 0.69586971
57 24456.63  3410.7395  11633143.6  0.67835216 0.13946070
58 26336.34  4277.4598  18296661.9  0.62670078 0.16241662
59 16996.88  1726.1703   2979664.0  0.32191512 0.10155806
60 21694.07  5586.4342  31208247.3  0.41714732 0.25750971
61 13001.25  1283.9048   1648411.5  5.98374890 0.09875244
62 18465.25  3787.5902  14345839.6 -0.53021537 0.20511986
63 18303.20  7692.6257  59176489.7  1.19968844 0.42028858
64 26403.02  3950.9600  15610084.7 -0.16628639 0.14964046
65 29483.86  5240.6913  27464845.8 -0.03662150 0.17774779
66 39627.60  5939.7432  35280549.4  2.79485609 0.14988906
67 31222.95 20177.8114 407144072.6  1.17435721 0.64624938
68 38729.57 13251.8288 175610966.4  1.87097064 0.34216308
69 21023.94  4320.0698  18663002.8  0.33292211 0.20548333
70 21779.33  7897.1802  62365454.8  0.84949897 0.36259973
71 36145.76  7572.2763  57339368.9  0.60666792 0.20949281
72 18320.55  7250.8272  52574495.5  2.82295265 0.39577568
73 32111.38  6803.2988  46284874.5 -0.78168385 0.21186567
74 31241.75  6281.7162  39459957.9  1.01170224 0.20106800
75 14149.53  3479.5527  12107287.0  0.61165691 0.24591292
76 30094.68  5357.3059  28700726.8  1.43635637 0.17801508
77 20612.58  1021.5081   1043478.9 -1.22827158 0.04955751
78 28030.22 16659.8549 277550765.8  1.55786400 0.59435324
79 11568.42  4599.1330  21152024.5  2.42445803 0.39755941
80 30072.20 20122.3972 404910869.5  1.07612199 0.66913621
81 20798.53  6099.8177  37207775.7  0.91816728 0.29328120
82 20711.07  2402.3836   5771447.0  1.04546797 0.11599516
83 31736.24  3995.0473  15960402.8 -3.74328455 0.12588280
84 73545.30 17307.2896 299542274.1 -0.94731806 0.23532827
85 22871.95  1329.5897   1767808.8  3.12696176 0.05813188
86 32486.94 11032.8903 121724668.1  1.59450531 0.33961003
87 17429.45  2571.4590   6612401.6 -0.50838795 0.14753533
88 17096.49   926.3095    858049.3 -0.68882538 0.05418127</code></pre>
</div>
</div>
<p>GDPPC_LM refers to <strong>local means</strong></p>
<p>GDPPC_LSD refers to <strong>local standard deviation</strong></p>
<p>GDPPC_LVar refers to <strong>local variance</strong></p>
<p>GDPPC_LSKe refers to <strong>local skew</strong></p>
<p>GDPPC_LCV refers to <strong>local coefficients of variation</strong></p>
<section id="homework-plot-different-thematic-maps-using-gwss-results" class="level4">
<h4 class="anchored" data-anchor-id="homework-plot-different-thematic-maps-using-gwss-results">Homework: Plot Different Thematic Maps Using GWSS Results</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>gwstat_df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   GDPPC_LM  GDPPC_LSD  GDPPC_LVar  GDPPC_LSKe  GDPPC_LCV
1  26797.76  5368.4595  28820357.0  0.66633204 0.20033243
2  21194.35  1698.0390   2883336.3  2.09614479 0.08011754
3  27755.09  4825.3960  23284446.3  0.64707878 0.17385627
4  27142.60  4146.6643  17194824.5  1.16119871 0.15277327
5  27681.99  4332.3440  18769204.5  0.92967739 0.15650406
6  24249.16  3670.7229  13474206.9 -0.85466668 0.15137523
7  59246.71 22419.9966 502656247.4 -0.62939642 0.37841757
8  50685.94 16702.7409 278981554.2 -0.86488843 0.32953402
9  69729.10 15306.7753 234297370.2 -0.84589675 0.21951775
10 19740.12  8635.5046  74571939.8  1.07796143 0.43745947
11 24375.01 22290.1025 496848668.9  1.18483157 0.91446544
12 29322.23  5962.4104  35550337.5 -1.88571194 0.20334096
13 23969.10  5043.2717  25434589.3  0.56523820 0.21040723
14 25383.12 24258.0380 588452406.9  1.03964154 0.95567593
15 21816.34  5040.3276  25404902.6  1.04816353 0.23103455
16 36359.36 16102.9533 259305105.8  0.56214571 0.44288329
17 42389.06 24307.7075 590864643.0 -0.32129825 0.57344291
18 23672.87  2642.5387   6983010.8 -2.57545765 0.11162733
19 27607.43  3389.1128  11486085.5  1.50576400 0.12276090
20 22223.48  1889.3881   3569787.4  0.97182679 0.08501764
21 24679.04  2679.7697   7181165.8 -1.15519704 0.10858485
22 26558.82  7204.3387  51902495.6  0.01029577 0.27125975
23 19778.52  2879.7720   8293087.0  1.11653676 0.14560101
24 18458.67  5484.3159  30077721.1  1.62822457 0.29711324
25 23423.43  7021.5422  49302054.4  0.03116617 0.29976582
26 16541.26  2397.1846   5746493.9  0.60063497 0.14492156
27 16545.42  3392.6269  11509917.5  0.06849616 0.20504933
28 15066.82  4122.0062  16990935.1  3.08938061 0.27358169
29 14821.56  3662.2795  13412290.8  0.44253465 0.24709131
30 16915.67  2471.5922   6108768.0  0.72194074 0.14611257
31 15183.78  3588.4893  12877255.6  2.94946079 0.23633700
32 21541.65  5069.4678  25699503.7 -1.43147322 0.23533329
33 19601.11  3108.9744   9665722.0  0.50522382 0.15861214
34 32412.12 24242.1346 587681090.0  0.53522173 0.74793418
35 20599.49  4617.7969  21324048.0  1.19120123 0.22417046
36 28859.13 23348.8623 545169370.5  0.85575588 0.80906328
37 11984.64  2493.0666   6215381.2  0.86286370 0.20802177
38 17861.63  4667.0959  21781784.0 -0.94299674 0.26129176
39 12911.26  2058.7063   4238271.6  0.57312479 0.15945051
40 10313.11  1358.4328   1845339.8  1.46878192 0.13171898
41 22146.45  4918.0988  24187695.5 -1.25740463 0.22207165
42 14975.46  2055.6929   4225873.1 -1.70732382 0.13727074
43 12164.44  1245.7923   1551998.4  1.22251626 0.10241262
44 13193.61  3927.1815  15422754.5  1.39569677 0.29765777
45 28443.02 24377.4421 594259684.0  0.77640738 0.85706245
46 47125.62 15312.7089 234479054.1 -0.27861152 0.32493383
47 38611.99 14830.2228 219935507.2  0.36610524 0.38408332
48 17657.75  5844.9396  34163319.0  1.30857144 0.33101270
49 17491.60  6505.9155  42326936.2  1.45654920 0.37194513
50 15515.46  7517.4264  56511699.0  1.54877539 0.48451204
51 20510.72  6286.3751  39518511.4  0.76211517 0.30649211
52 26867.31  6659.8455  44353542.2 -0.81626138 0.24787916
53 10537.76  1827.5034   3339768.6  1.73988753 0.17342427
54 21458.65  6410.2129  41090829.2  0.92850266 0.29872402
55 11158.95  2038.4420   4155245.7  0.87994007 0.18267325
56 17755.28 12355.3608 152654940.8  3.44850457 0.69586971
57 24456.63  3410.7395  11633143.6  0.67835216 0.13946070
58 26336.34  4277.4598  18296661.9  0.62670078 0.16241662
59 16996.88  1726.1703   2979664.0  0.32191512 0.10155806
60 21694.07  5586.4342  31208247.3  0.41714732 0.25750971
61 13001.25  1283.9048   1648411.5  5.98374890 0.09875244
62 18465.25  3787.5902  14345839.6 -0.53021537 0.20511986
63 18303.20  7692.6257  59176489.7  1.19968844 0.42028858
64 26403.02  3950.9600  15610084.7 -0.16628639 0.14964046
65 29483.86  5240.6913  27464845.8 -0.03662150 0.17774779
66 39627.60  5939.7432  35280549.4  2.79485609 0.14988906
67 31222.95 20177.8114 407144072.6  1.17435721 0.64624938
68 38729.57 13251.8288 175610966.4  1.87097064 0.34216308
69 21023.94  4320.0698  18663002.8  0.33292211 0.20548333
70 21779.33  7897.1802  62365454.8  0.84949897 0.36259973
71 36145.76  7572.2763  57339368.9  0.60666792 0.20949281
72 18320.55  7250.8272  52574495.5  2.82295265 0.39577568
73 32111.38  6803.2988  46284874.5 -0.78168385 0.21186567
74 31241.75  6281.7162  39459957.9  1.01170224 0.20106800
75 14149.53  3479.5527  12107287.0  0.61165691 0.24591292
76 30094.68  5357.3059  28700726.8  1.43635637 0.17801508
77 20612.58  1021.5081   1043478.9 -1.22827158 0.04955751
78 28030.22 16659.8549 277550765.8  1.55786400 0.59435324
79 11568.42  4599.1330  21152024.5  2.42445803 0.39755941
80 30072.20 20122.3972 404910869.5  1.07612199 0.66913621
81 20798.53  6099.8177  37207775.7  0.91816728 0.29328120
82 20711.07  2402.3836   5771447.0  1.04546797 0.11599516
83 31736.24  3995.0473  15960402.8 -3.74328455 0.12588280
84 73545.30 17307.2896 299542274.1 -0.94731806 0.23532827
85 22871.95  1329.5897   1767808.8  3.12696176 0.05813188
86 32486.94 11032.8903 121724668.1  1.59450531 0.33961003
87 17429.45  2571.4590   6612401.6 -0.50838795 0.14753533
88 17096.49   926.3095    858049.3 -0.68882538 0.05418127</code></pre>
</div>
</div>


</section>
</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>